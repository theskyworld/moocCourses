### é¡¹ç›®åˆ†æ

â€‹ ![image-20230826080141526](C:\Users\ycx\AppData\Roaming\Typora\typora-user-images\image-20230826080141526.png)

### ä¸šåŠ¡é—­ç¯

é—®å·åˆ›å»ºè€… â†’ æ–°å»ºé—®å· â†’ ç¼–è¾‘é—®å· â†’ å‘å¸ƒé—®å· â†’ é—®å·H5é¡µé¢
   ğŸ‘†                                           â¬‡
åˆ†æç»“æœ   ğŸ‘ˆ  åå°ç»Ÿè®¡å¹¶åˆ†æé¡µé¢  ğŸ‘ˆ ç”¨æˆ·å¡«å†™é¡µé¢å¹¶æäº¤

### é¡¹ç›®ç»„ä»¶åˆ†æ

![image-20230826080407619](C:\Users\ycx\AppData\Roaming\Typora\typora-user-images\image-20230826080407619.png)

### é¡¹ç›®é¡µé¢

![image-20230828141801145](C:\Users\ycx\AppData\Roaming\Typora\typora-user-images\image-20230828141801145.png)

è·¯ç”±è®¾è®¡

- é¦–é¡µ `'/'`
- ç™»å½•é¡µ `'/login'`
- æ³¨å†Œé¡µ `'/register'`
- é—®å·ç®¡ç†
  - æˆ‘çš„é—®å· `'/manage/list'`
  - æ˜Ÿæ ‡é—®å· `'/manage/star'`
  - å›æ”¶ç«™ `'/manage/trash'`
- é—®å·è¯¦æƒ…
  - ç¼–è¾‘é—®å· `/question/edit/:id`
  - é—®å·ç»Ÿè®¡ `/question/stat/:id`
- 404

### API è®¾è®¡

è®¾è®¡æ—¶å¯¹åº”çš„å‰ç«¯éœ€æ±‚

- è·Ÿç”¨æˆ·ç›¸å…³
  - æ³¨å†Œ
  - ç™»å½•
  - è·å–ç”¨æˆ·ä¿¡æ¯
- è·Ÿé—®å·ç›¸å…³
  - åˆ›å»ºé—®å·
  - è·å–å•ä¸ªé—®å·
  - æ›´æ–°é—®å·
  - åˆ é™¤é—®å·
  - æŸ¥è¯¢é—®å·åˆ—è¡¨
  - å¤åˆ¶é—®å·

#### ç”¨æˆ·åŠŸèƒ½

##### è·å–ç”¨æˆ·ä¿¡æ¯

`errno`ä¸ºé”™è¯¯ç¼–å·ï¼Œå…¶å€¼ä¸ºé”™è¯¯ç¼–ç åº“ä¸­å®šä¹‰çš„å€¼

- method `get`
- path `/api/user/info`
- response `{ errno: 0, data: {...} }` æˆ– `{ errno: 10001, msg: 'xxx' }`

##### æ³¨å†Œ

- method `post`
- path `/api/user/register`
- request body `{ username, password, nickname }`
- response `{ errno: 0 }`

##### ç™»å½•

- method `post`
- path `/api/user/login`
- request body `{ username, password }`
- response `{ errno: 0, data: { token } }` â€”â€” **JWT** ä½¿ç”¨ token

#### é—®å·åŠŸèƒ½

##### åˆ›å»ºé—®å·

- method `post`
- path `/api/question`
- request body - æ—  ï¼ˆç‚¹å‡»ä¸€ä¸ªæŒ‰é’®å³å¯åˆ›å»ºï¼Œtitle è‡ªåŠ¨ç”Ÿæˆï¼‰
- response `{ errno: 0, data: { id } }`

##### è·å–å•ä¸ªé—®å·

- method `get`
- path `/api/question/:id`
- response `{ errno: 0, data: { id, title ... } }`

##### è·å–é—®å·åˆ—è¡¨

- method `get`
- path `/api/question-list`
- response: `{ errno: 0, data: { list: [ ... ], total } }`

##### æ›´æ–°é—®å·ä¿¡æ¯

- method `patch`
- path `/api/question/:id`
- request body `{ title, isStar ... }` ï¼ˆä¹‹å‰å¿˜è®°äº†ï¼Œç°è¡¥ä¸Šï¼‰
- response: `{ errno: 0 }`

PSï¼šåˆ é™¤æ˜¯`å‡åˆ é™¤`ï¼Œå®é™…æ˜¯æ›´æ–° `isDeleted` å±æ€§

##### æ‰¹é‡å½»åº•åˆ é™¤é—®å·

- method `delete`
- path `/api/question`
- request body `{ ids: [ ... ] }`
- response: `{ errno: 0 }`

##### å¤åˆ¶é—®å·

- method `post`
- path `/api/question/duplicate/:id`
- response: `{ errno: 0, data: { id } }`

#### å°ç»“

- ä½¿ç”¨ Restful API
- ç”¨æˆ·éªŒè¯ä½¿ç”¨ JWT ï¼ˆåé¢å†è®²ï¼‰
- ç»Ÿä¸€è¿”å›æ ¼å¼ `{ errno, data, msg }`

### è§£è€¦

#### ç»„ä»¶ä¹‹é—´çš„è§£è€¦

- æœç´¢æ¡†ä¸åˆ—è¡¨å±•ç¤ºç»„ä»¶ä¹‹é—´çš„è§£è€¦ï¼šæœç´¢æ¡†çš„æœç´¢ç»“æœä¸æ—¶æ¥æºäºåˆ—è¡¨å±•ç¤ºç»„ä»¶ä¹‹ä¸­å·²æœ‰æ•°æ®çš„è¿‡æ»¤ç»“æœï¼Œè€Œæ˜¯é€šè¿‡è¾“å…¥æœç´¢å…³é”®å­—ä¹‹åï¼Œå°†å…³é”®å­—ä¿¡æ¯æ·»åŠ åˆ°urlä¸­ï¼Œåˆ°åç«¯è¯·æ±‚åˆ°å¯¹åº”çš„æœç´¢ç»“æœæ•°æ®ã€‚å½“éœ€è¦urlä¸­ç›¸å…³çš„æ•°æ®æ—¶ï¼Œå¯é€šè¿‡`useSearchParams`å‡½æ•°è¿›è¡Œè·å–
- åˆ†é¡µä¸åˆ—è¡¨å±•ç¤ºç»„ä»¶ä¹‹é—´çš„è§£è€¦ï¼šç±»ä¼¼äºæœç´¢æ¡†ï¼Œå°†å½“å‰é¡µæ•°ä¿¡æ¯æ·»åŠ åˆ°urlä¸­ï¼Œå‘åç«¯è¯·æ±‚åˆ°å¯¹åº”é¡µçš„æ•°æ®
- åŒæ—¶æ˜Ÿæ ‡é—®å·å’Œå›æ”¶ç«™ç»„ä»¶ä¸åˆ—è¡¨ç»„ä»¶ä¹‹é—´çš„è§£è€¦ä¹Ÿä¸ä¸Šé¢ç±»ä¼¼ï¼Œå°†`isStar`å’Œ`isDeleted`çš„ä¿¡æ¯ä¼ é€’ç»™åç«¯ï¼Œè¿›è¡Œæ•°æ®çš„è¯·æ±‚

#### ç»„ä»¶æ•°æ®ä¹‹é—´çš„è§£è€¦

- ä½¿ç”¨çŠ¶æ€æå‡ï¼Œå¤šä¸ªå­ç»„ä»¶çš„æ•°æ®å­˜å‚¨åœ¨å…±åŒçš„çˆ¶ç»„ä»¶ä¸­ï¼Œé€šè¿‡propså‘å­ç»„ä»¶ä¸­ä¼ é€’æ•°æ®
- ä½¿ç”¨çŠ¶æ€ç®¡ç†
  - ä½¿ç”¨[Context](https://react.dev/learn/passing-data-deeply-with-context)
    - ç±»ä¼¼äºVueä¸­çš„`provide/inject`
    - å¤šç”¨äºä¾‹å¦‚ä¸»é¢˜åˆ‡æ¢ã€è¯­è¨€åˆ‡æ¢ä¸­
  - ä½¿ç”¨[redux](https://redux.js.org/)
    - å¯¹æ•°æ®(state)è¿›è¡Œç»Ÿè®¡çš„ç®¡ç†(dispatch action)

### ç¼–è¾‘ç•Œé¢åˆ†æ

#### ç•Œé¢çš„æ¨¡å—

- é¡¶éƒ¨æ 
- å·¦ä¾§ - ç»„ä»¶åº“
- å·¦ä¾§ - å›¾å±‚
- ä¸­é—´ - ç”»å¸ƒ
- å³ä¾§ - å±æ€§
- å³ä¾§ - é¡µé¢è®¾ç½®

#### åŠŸèƒ½åˆ—è¡¨

é¡¶éƒ¨æ 

- è¿”å›
- æ˜¾ç¤ºæ ‡é¢˜ï¼Œä¿®æ”¹æ ‡é¢˜
- å·¥å…·æ 
  - åˆ é™¤
  - éšè—
  - é”å®š
  - å¤åˆ¶ï¼Œç²˜è´´
  - ä¸Šç§»ï¼Œä¸‹ç§»
  - æ’¤é”€ï¼Œé‡åš
- ä¿å­˜ï¼Œè‡ªåŠ¨ä¿å­˜ï¼Œctrl + s å¿«æ·é”®
- å‘å¸ƒ

å·¦ä¾§ ç»„ä»¶åº“

- æ˜¾ç¤ºç»„ä»¶åˆ—è¡¨
  - ï¼ˆå„ä¸ªç»„ä»¶ï¼Œçœ‹ç³»ç»Ÿï¼‰
- ç‚¹å‡»æ·»åŠ ç»„ä»¶åˆ°ç”»å¸ƒ

å·¦ä¾§ å›¾å±‚

- æ˜¾ç¤ºå›¾å±‚åˆ—è¡¨
- æ‹–æ‹½æ’åº
- å•å‡»ï¼Œé€‰ä¸­
- åŒå‡»ï¼Œä¿®æ”¹æ ‡é¢˜
- éšè—
- é”å®š

ä¸­é—´ ç”»å¸ƒ

- å±•ç¤ºç»„ä»¶åˆ—è¡¨
- Y æ»šåŠ¨æ¡
- æ‹–æ‹½æ’åº
- å•å‡»ï¼Œé€‰ä¸­
- å¿«æ·é”®
  - delete backspace
  - up
  - down
  - ctrl + c , v
  - ctrl + z , ctrl + shift + z
  - ctrl + s ï¼Œä¿å­˜

å³ä¾§ å±æ€§

- ä¿®æ”¹å±æ€§

å³ä¾§ é¡µé¢è®¾ç½®

- æ ‡é¢˜ï¼Œæè¿°
- JS CSS ä»£ç 
- tab è‡ªåŠ¨åˆ‡æ¢

#### ç•Œé¢å¸ƒå±€

- ä¸Šä¸‹å¸ƒå±€
- ä¸‹é¢å·¦ä¸­å³å±€éƒ¨
- ä¸­éƒ¨ï¼Œä¸Šä¸‹å·¦å³å±…ä¸­å¸ƒå±€
- ä¸­éƒ¨èƒ½æ²¿yè½´æ»šåŠ¨

### é¡µé¢ä¸­æ‹–æ‹½æ’åºåŠŸèƒ½çš„å®ç°

ä½¿ç”¨ä»¥ä¸‹ç¬¬ä¸‰æ–¹æ’ä»¶ä¸­çš„ä¸€ç§

- [React-dnd](https://react-dnd.github.io/react-dnd/about)
- [React-beautiful-dnd](https://github.com/atlassian/react-beautiful-dnd)
- [Sortable.js](https://sortablejs.github.io/Sortable/)
- [React-sortable-hoc](https://github.com/clauderic/react-sortable-hoc)
- [Dnd-Kit](https://dndkit.com/)

é€‰æ‹©æ’ä»¶æ—¶ï¼Œè€ƒè™‘ä»¥ä¸‹å†…å®¹

- Github starå¤šï¼Œä»£ç æ›´æ–°åŠæ—¶
- npmä¸Šä¸‹è½½é‡å¤§ï¼Œæœ€è¿‘çš„å‘å¸ƒæ—¶é—´è¾ƒè¿‘
- æ–‡æ¡£å’Œdemoé€šä¿—æ˜“æ‡‚
- æ˜¯å¦å­˜åœ¨ä½œè€…å…¬å¸ƒçš„ä¾‹å¦‚æš‚åœç»´æŠ¤ç­‰ä¿¡æ¯

### æ’¤é”€é‡åšçš„å®ç°åŸç†

#### ä½¿ç”¨ä¸‰ä¸ªå˜é‡è¿›è¡Œå­˜å‚¨

- present : å­˜å‚¨é¡µé¢ä¸­çš„å½“å‰æ•°æ®å€¼
- past : ä¸€ä¸ªæ•°ç»„æ ˆç»“æ„ï¼Œå­˜å‚¨é¡µé¢ä¸­çš„è¿‡å»æ•°æ®å€¼
- future : ä¸€ä¸ªæ•°ç»„æ ˆç»“æ„ï¼Œå­˜å‚¨é¡µé¢ä¸­çš„å°†æ¥æ•°æ®å€¼

#### æ•°æ®çš„æ›´æ–°æµç¨‹

ä»¥ä¸€ä¸ªè¾“å…¥æ¡†ä¸­è¾“å…¥å€¼çš„æ’¤é”€é‡åšä¸ºä¾‹

- æ’¤é”€ : pastå‡ºæ ˆï¼Œfutureå…¥æ ˆï¼Œpresenté‡æ–°è¢«èµ‹å€¼
- é‡åš : futureå‡ºæ ˆï¼Œpastå…¥æ ˆï¼Œpresenté‡æ–°è¢«èµ‹å€¼
- æ‰‹åŠ¨è¾“å…¥æ–°å€¼ : pastå…¥æ ˆï¼Œfutureè¢«æ¸…ç©ºå†…å®¹

#### ä½¿ç”¨å·¥å…·

ä¹Ÿå¯ä»¥ä½¿ç”¨ä¾‹å¦‚[redux-undo](https://www.npmjs.com/package/redux-undo)å·¥å…·ï¼Œæ— éœ€æ‰‹åŠ¨å¯¹æ•°æ®è¿›è¡Œç»´æŠ¤ï¼Œç›´æ¥å¯¹å…¶å°è£…å¥½çš„åŠŸèƒ½è¿›è¡Œä½¿ç”¨å³å¯

### ç»Ÿè®¡é¡µé¢åˆ†æ

#### ç•Œé¢çš„æ¨¡å—

- é¡¶éƒ¨æ 
- å·¦ä¾§ ç»„ä»¶åˆ—è¡¨
- ä¸­é—´ ç­”å·åˆ—è¡¨
- å³ä¾§ å›¾è¡¨ç»Ÿè®¡

#### åŠŸèƒ½åˆ—è¡¨

é¡¶éƒ¨æ 

- è¿”å›
- æ˜¾ç¤ºæ ‡é¢˜
- æ˜¾ç¤º url
- å¤åˆ¶ url
- æ˜¾ç¤ºäºŒç»´ç 
- ç¼–è¾‘é—®å·

å·¦ä¾§ ç»„ä»¶åˆ—è¡¨

- æ˜¾ç¤ºç»„ä»¶åˆ—è¡¨
- ç‚¹å‡»é€‰ä¸­ç»„ä»¶

ä¸­é—´ ç­”å·åˆ—è¡¨

- æ˜¾ç¤ºç­”å·æ•°é‡
- æ˜¾ç¤ºç­”å·è¡¨æ ¼ï¼Œåˆ†é¡µ
- ç‚¹å‡» th é€‰ä¸­ç»„ä»¶

å³ä¾§ å›¾è¡¨ç»Ÿè®¡

- æ ¹æ®é€‰ä¸­çš„ç»„ä»¶ï¼Œæ˜¾ç¤ºå›¾è¡¨ç»Ÿè®¡

### é—®å·ç»Ÿè®¡æ•°æ®ç»“æ„åˆ†æ

**ä¸€ä¸ªé—®å·** å‘å¸ƒäº†ï¼Œç”¨æˆ·æäº¤çš„**ä¸€ä»½ç­”å·**ï¼Œæ•°æ®ç»“æ„å¦‚ä¸‹ï¼š

```js
{
    questionId: '63a51dd42ef26594341e2aff',
    answerList: [
        { componentId: 'c1', value: undefined }, // æ ‡é¢˜ info
        { componentId: 'c2', value: 'å¼ ä¸‰' }, // input
        { componentId: 'c3', value: '13987650099' }, // input
        { componentId: 'c4', value: '1-3å¹´' }, // å•é€‰
        { componentId: 'c5', value: 'Vue2,Vue3' }, // å¤šé€‰
        { componentId: 'c6', value: 'å¤§äº20k' }, // å•é€‰
        { componentId: 'c7', value: 'å¤‡æ³¨xx' } // textarea
    ]
}
```

**ä¸€ä¸ªé—®å·å¯¹åº”å¤šä¸ªç­”å·**ï¼Œæ‰€ä»¥ä¸€ä¸ªé—®å·çš„æ‰€æœ‰ç­”å·åˆ—è¡¨å¦‚ä¸‹ï¼š

```js
[
    // ç”¨æˆ·A
    {
        _id: 'xx',
        c2: 'å¼ ä¸‰',
        c3: '13987650099',
        c4: '1-3å¹´', // å•é€‰
        c5: 'Vue2,Vue3', // å¤šé€‰
        c6: 'å¤§äº20k',
        c7: 'å¤‡æ³¨xx'
    },
    // ç”¨æˆ·B
    {
        _id: 'y',
        c2: 'æå››',
        c3: 'lisi@163.com',
        c4: '3-5å¹´',
        c5: 'Vue2,React',
        c6: '10-20k',
        c7: 'å¤‡æ³¨yy'
    },
    // æ›´å¤šç”¨æˆ·...
]
```

#### å®Œå–„ mock

æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥è®¾ç½® mock

```js
// url `/api/stat/:questionId`
// method `get`
{
    errno: 0,
    data: {
        total: 100, // åˆ†é¡µ
        list: [ /* ä¸Šé¢çš„ç­”å·åˆ—è¡¨ */ ]
    }
}
```

### å›¾è¡¨åˆ†æå·¥å…·

- [React-chartjs-2](https://react-chartjs-2.js.org/)
- [recharts](https://recharts.org/)
- [echarts-for-react](https://www.npmjs.com/package/echarts-for-react)
